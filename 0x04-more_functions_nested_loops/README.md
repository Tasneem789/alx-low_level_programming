More and more nested functions and tasks gonna kill me
